# MediaOp 数据分析系统产品需求文档

## 1. 项目概述

### 1.1 项目背景
作为短视频带货账号的运营人员，需要对多个达人的带货数据进行有效监控和分析，以快速识别热门商品和优秀达人，从而优化内容策略和提升带货效果。

### 1.2 项目目标
开发一个数据分析系统，帮助运营人员：
1. 快速识别达人最近拍摄的商品及其品类表现
2. 快速获取特定商品或品类下表现优秀的带货视频
3. 通过数据矩阵图全面了解商品拍摄频次和表现情况

## 2. 业务需求

### 2.1 功能需求

#### 2.1.1 达人商品数据分析
- 展示指定达人最近拍摄的商品
- 按品类维度统计商品的点赞、收藏、转发数据
- 支持按数据指标从高到低排序展示
- 支持按一级分类筛选

#### 2.1.2 商品视频数据分析
- 展示指定商品相关的带货视频数据
- 支持按点赞、收藏、转发等指标排序查看
- 显示视频的详细统计数据

#### 2.1.3 数据矩阵图展示
- 以商品为维度，按拍摄次数和数据表现两个维度展示矩阵图
- 支持快速识别多人拍摄且数据表现良好的商品
- 支持按不同数据指标查看矩阵图

### 2.2 非功能需求
- 支持移动端响应式设计
- 提供3、5、7、30天时间范围快捷选择
- 数据预计算以提高查询性能

## 3. 数据说明

### 3.1 数据源
系统基于以下数据表进行分析：
1. `DyCreator`: 达人基本信息表
2. `DouyinAweme`: 视频基本信息表
3. `DouyinAwemeSummary`: 视频详细信息及商品关联表（每日多次抓取）
4. `ProductInfo`: 商品品类信息表

### 3.2 数据处理逻辑
- 视频日增量计算：使用每天最晚记录减去最早记录计算增量
- 新发布视频：使用总量数据
- 历史视频：只有一天数据的直接跳过

### 3.3 数据关联关系
- 商品与品类信息：通过product_id字段关联
- 达人信息关联：通过user_id字段关联

## 4. 功能详细说明

### 4.1 达人商品分析功能

#### 4.1.1 功能描述
展示指定达人最近拍摄的商品，按品类维度统计点赞、收藏、转发数据，并支持排序和筛选。

#### 4.1.2 输入参数
- 达人ID（必填）
- 时间范围（3/5/7/30天，默认7天）
- 排序字段（点赞/收藏/转发，默认点赞）
- 一级分类（可选）

#### 4.1.3 输出数据
- 商品ID
- 商品标题
- 一级分类
- 二级分类
- 视频数量
- 平均点赞数
- 平均收藏数
- 平均转发数
- 总点赞数
- 总收藏数
- 总转发数

### 4.2 商品视频分析功能

#### 4.2.1 功能描述
展示指定商品相关的带货视频数据，支持按不同指标排序查看。

#### 4.2.2 输入参数
- 商品ID（必填）
- 时间范围（3/5/7/30天，默认7天）
- 排序字段（点赞/收藏/转发，默认点赞）

#### 4.2.3 输出数据
- 视频ID
- 视频标题
- 达人昵称
- 发布时间
- 点赞数
- 收藏数
- 转发数

### 4.3 数据矩阵图功能

#### 4.3.1 功能描述
以商品为维度，按拍摄次数和数据表现两个维度展示矩阵图，帮助快速识别优质商品。

#### 4.3.2 输入参数
- 时间范围（3/5/7/30天，默认7天）
- 指标字段（点赞/收藏/转发，默认点赞）

#### 4.3.3 输出数据
- 商品ID
- 商品标题
- 一级分类
- 二级分类
- 视频数量（拍摄次数）
- 总指标数（根据选择的指标字段）
- 平均指标数（根据选择的指标字段）

## 5. 技术实现方案

### 5.1 系统架构
采用前后端分离架构：
- 前端：React + Ant Design（支持响应式）
- 后端：Python + FastAPI
- 数据库：MySQL

### 5.2 数据预处理
为提高查询性能，系统需要预计算以下数据：
1. 商品达人统计数据表（product_creator_stats）
2. 商品矩阵统计数据表（product_matrix_stats）

### 5.3 定时任务
- 视频增量计算任务：每小时执行一次
- 统计数据预计算任务：每天凌晨2点执行

## 6. 页面设计

### 6.1 达人商品分析页面
- 达人选择器
- 时间周期选择器（3/5/7/30天）
- 排序字段选择器（点赞/收藏/转发）
- 一级分类筛选器
- 商品品类数据表格展示

### 6.2 商品视频分析页面
- 商品搜索功能
- 时间周期选择器（3/5/7/30天）
- 排序字段选择器（点赞/收藏/转发）
- 视频数据排行榜展示

### 6.3 数据矩阵图页面
- 时间周期选择器（3/5/7/30天）
- 指标字段选择器（点赞/收藏/转发）
- 矩阵图可视化展示
- 商品详情查看功能

## 7. 实施计划

### 7.1 第一阶段：数据模型和处理逻辑（2周）
1. 创建预计算数据表
2. 实现视频增量计算任务
3. 实现统计数据预计算任务

### 7.2 第二阶段：API服务开发（1.5周）
1. 实现达人商品分析接口
2. 实现商品视频分析接口
3. 实现数据矩阵图接口

### 7.3 第三阶段：前端界面开发（2周）
1. 开发达人商品分析页面
2. 开发商品视频分析页面
3. 开发数据矩阵图页面
4. 实现响应式设计适配移动端

## 8. 验收标准

### 8.1 功能验收
- 所有功能模块按需求文档实现
- 页面交互流畅，数据展示准确
- 移动端适配良好

### 8.2 性能验收
- 页面加载时间不超过3秒
- 数据查询响应时间不超过1秒
- 支持至少100个并发用户访问

### 8.3 兼容性验收
- 支持主流浏览器（Chrome、Firefox、Safari、Edge）
- 支持移动端访问（iOS、Android）